<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="../../text_style.css">
<title>E2: cellconnect </title>
</head>
<body>
<h1>E2: cellconnect</h1>
<p>
This module provides algorithms which are able to <em>set-up</em> synapses between cells in
a neural tissue s.t. the resulting tissue has some desired <em>network properties</em>.
It means that here we consider a neural tissue to be a network (graph) with cells
representing nodes and synapses representing links (edges). A network property is
then any property we can tell about a network from the point of view of the graph/network
theory. Here we primarily focus on the following very important
network properties: small-world property, power-law distribution of in/out-degrees
of cells (i.e. is the network scale-free), and clustering coefficients of cells.
</p>
<h2 id="motivation">Motivation</h2>
<p>
Number of cells in a neural tissue can be quite large. An exact specification of
connections between cells requires a space comparable with the size of the tissue
itself (remember that number of synapses is dominant in any realistic tissue).
And that is not acceptable. Our goal thus is to provide an alternative
specification with the following properties:
</p>
<ul><li>
    It has negligible memory requirements compared to size of the tissue.
</li><li>
    It still allow us to specify desired network properties of the tissue.
</li><li>
    We can construct algorithms which can efficiently interconnect cells
    in the tissue according to the specification.
</li></ul>
<p>
Our solution splits the whole problem into a sequence of three sub-problems.
First, we interconnect only cells appearing in the same column. Then
we spread synapses from original cells to cells in other columns. And we
finish by setting up delimiters of migration lists for each cells in the tissue.
These three parts are described in details in the following three sections.
</p>
<p>
Remember that to interconnect a source and a target cell by a synapse equals
to setting coordinates of the source cell to the synapse in the territory of
the target cells. Therefore, the first two sub-problems only set coordinates
of source cells to synapses. No other properties of synapses are neither read
nor written.
</p>
<h2 id="column_setup">Set-up of synapses in column</h2>
<p>
Each column in a neural tissue has exactly the same structure. We can thus apply
the same set-up procedure for each column. In the following we describe the procedure
for a column at given tissue coordinates (<i>x,y</i>). Let us see a structure of the
column along the columnar axis.
</p>
<img src="./column_and_sensory_cells.svg" alt="[column_and_sensory_cells.svg]">
<p>
We see <i>K</i> kinds of tissue cells. <i>i</i>-th kind has exactly
<i>N<sub>i</sub></i> cells. Each cell of <i>i</i>-th kind has a territory for exactly
<i>T<sub>i</sub></i> synapses. We further see in the picture the mapping of sensory cells
to their coordinates along the columnar axis. There are <i>S</i> kinds of sensory cells
and <i>i</i>-th kind has exactly <i>N<sub>i</sub></i> sensory cells.
</p><p>
Each synapse is associated with tissue coordinates of its source cell (projecting the axon).
Our goal is to set-up coordinates to source cells of each synapse in the territory of each cell
in the column. Note that all these coordinates may differ only in the third coordinate (i.e.
along the columnar axis).
</p><p>
Ideally we should specify for each tissue and sensory cell how many synapses it
projects into what tissue cell. Nevertheless, the size of this specification depends
on the length of the columnar axis of the tissue, i.e. it can be large
(<i>C&times;C<sub>S</sub></i> records). We thus propose a different specification,
where we focus on <em>kinds</em> of cell instead of individual cells.
Namely, for each kind of tissue cells
0 &le; <i>i</i> &lt; <i>K</i>
and for each kind of tissue or sensory cells
0 &le; <i>j</i> &lt; <i>K+S</i>
we specify a number
<i>a<sub>i,j</sub></i>
of synapses which are projected from <em>each</em> cell of the kind <i>j</i> to
<em>each</em> cell of the kind <i>i</i>. We can put all the numbers
<i>a<sub>i,j</sub></i>
into a matrix <i>A</i> of dimensions <i>K&times;(K+S)</i>:
</p>
<img src="./column_fill_matrix.svg" alt="[column_fill_matrix.svg]">
<p>
For each
0 &le; <i>i</i> &lt; <i>K</i>
the matrix <i>A</i> must satisfy
<i>T<sub>i</sub>N<sub>i</sub></i> =
(<i>a</i><sub><i>i</i>,0</sub><i>N</i><sub>0</sub> + &hellip; +
<i>a</i><sub><i>i,i</i></sub><i>N</i><sub><i>i</i></sub> + &hellip; +
<i>a</i><sub><i>i,K</i>&minus;1</sub><i>N</i><sub><i>K</i>&minus;1</sub>) +
(<i>a</i><sub><i>i,K</i></sub><i>N</i><sub><i>K</i></sub> + &hellip; +
<i>a</i><sub><i>i</i>,<i>K+S</i>&minus;1</sub><i>N</i><sub><i>K+S</i>&minus;1</sub>).
</p><p>
For each kind <i>i</i> of tissue cells we set coordinates of synapses in their
territories in a specific order. First we set coordinates of all synapses at the
index 0 in territories of all <i>N<sub>i</sub></i> cells, then coordinates of synapses
at the index 1 in territories of all <i>N<sub>i</sub></i> cells, and so forth.
</p><p>
In that order we write the following sequence of coordinates. First we generate
<i>a<sub>i,0</sub></i> times the coordinates of the first
cell of the kind 0, then <i>a<sub>i,0</sub></i> times the coordinates of the second
cell of the kind 0, and so forth. Then we continue similarly with coordinates of cells
of all remaining kinds, i.e. up to kind <i>K+S</i>&minus;1.
</p><p>
This algorithm is implemented as a function
<tt>fill_coords_of_source_cells_of_synapses_in_single_column</tt>
in a file
<a href="../../code/cellconnect/src/fill_coords_of_source_cells_of_synapses_in_tissue.cpp">
    fill_coords_of_source_cells_of_synapses_in_tissue.cpp</a>.
</p><p>
Since all columns are set-up exactly the same way (using the same algorithm and
the matrix <i>A</i>), we thus also provide an algorithm
<tt>fill_coords_of_source_cells_of_synapses_in_tissue</tt> declared in
<a href="../../code/cellconnect/include/cellconnect/fill_coords_of_source_cells_of_synapses_in_tissue.hpp">
    fill_coords_of_source_cells_of_synapses_in_tissue.hpp</a>,
which calls the algorithm above for each column in the tissue. The algorithm accepts
(besides the matrix <i>A</i>) a number of threads available for the computation. This
number determines how many columns will be set-up simultaneously.
</p>
<h2 id="spreading_synapses">Spreading synapses amongst columns</h2>
<p>
We present an algorithm distributing synapses (i.e. coordinates of their source
cells) of all tissue cells of a source kind 0 &le; <i>s</i> &lt; <i>K</i> to
territories of tissue cells of a target kind 0 &le; <i>t</i> &lt; <i>K</i> lying
in their local or distant neighbourhoods. In the following picture we show
a distribution of synapses from tissue cells in a single source column to territories
of tissue cells in columns lying in a neighbourhood of the source column.
</p>
<img src="./spread_synapses_top_view.svg" alt="[spread_synapses_top_view.svg]">
<p>
We see that cells in the source column have tissue coordinates (<i>x,y</i>). The center of
the neighbourhood of these cells lies at tissue coordinates (<i>x&prime;,y&prime;</i>).
We compute them form (<i>x,y</i>) using a <em>column-shift function</em> <i>F</i>.
We postpone its specification and the description of its properties to a
<a href="./cellconnect.html#column_shift_function">separate section</a>
below. We further see that the neighbourhood is a rectangle spanning over <i>m</i>
columns along the <i>X</i> axis and <i>n</i> columns along the <i>Y</i> axis.
In order to ensure the existence of the central cell we always assume that both
<i>m</i> and <i>n</i> are odd numbers greater than 1.
</p><p>
We know from the previous section (namely from the matrix <i>A</i>) that
tissue cells of a target kind <i>t</i> have together in their territories exactly
<i>a<sub>t,s</sub></i> synapses from each tissue cell of a source kind <i>s</i>.
Since there is exactly <i>N<sub>s</sub></i> tissue cells of the source kind <i>s</i>
in each column, we thus have to move exactly <i>a<sub>t,s</sub>N<sub>s</sub></i>
synapses (i.e. their coordinates to source cells) to territories of tissue cells
of the target kind <i>t</i> lying in the neighbourhood.
We use a specification matrix <i>H</i> of dimensions <i>m</i>&times;<i>n</i>
to specify how many synapses to move from the source column into what column in
the neighbourhood. Observe in the picture the direct correspondence between elements
of the matrix and columns in the neighbourhood. Clearly, the matrix <i>H</i> must
satisfy
</p><p>
<i>a<sub>t,s</sub>N<sub>s</sub></i> =
(<i>h</i><sub>0,0</sub> + &hellip; + <i>h</i><sub>0,<i>n</i>&minus;1</sub>) +
(<i>h</i><sub>1,0</sub> + &hellip; + <i>h</i><sub>1,<i>n</i>&minus;1</sub>) +
&hellip; +
(<i>h</i><sub><i>m</i>&minus;1,0</sub> + &hellip; + <i>h</i><sub><i>m</i>&minus;1,<i>n</i>&minus;1</sub>).
</p><p>
Let us fix some shift vector (&Delta;<i>x</i>,&Delta;<i>y</i>),
where
&minus;&lfloor;<i>m</i>/2&rfloor; &le; &Delta;<i>x</i> &le; &lfloor;<i>m</i>/2&rfloor;,
&minus;&lfloor;<i>n</i>/2&rfloor; &le; &Delta;<i>y</i> &le; &lfloor;<i>n</i>/2&rfloor;
and
<i>h</i><sub>&lfloor;<i>m</i>/2&rfloor;+&Delta;<i>x</i>,&lfloor;<i>n</i>/2&rfloor;+&Delta;<i>y</i></sub> &gt; 0.
<!--from the central cell of a neighbourhood to its particular column.-->
If we want to move a synapse from a column
<i>c</i><sub>0</sub>
at coordinates
(<i>x</i><sub>0</sub>,<i>y</i><sub>0</sub>)
to the column
<i>c</i><sub>1</sub>
at the coordinates
(<i>x</i><sub>1</sub>,<i>y</i><sub>1</sub>) =
    <i>F</i>(<i>x</i><sub>0</sub>,<i>y</i><sub>0</sub>) + (&Delta;<i>x</i>,&Delta;<i>y</i>),
then we have to find a place for the synapse in that column.
We use the place of a synapse which we have to move from the column <i>c</i><sub>1</sub>
to the column
<i>c</i><sub>2</sub>
at the coordinates
(<i>x</i><sub>2</sub>,<i>y</i><sub>2</sub>) =
    <i>F</i>(<i>x</i><sub>1</sub>,<i>y</i><sub>1</sub>) + (&Delta;<i>x</i>,&Delta;<i>y</i>).
There we use a place of a synapse which we move further according to the same
procedure. We continue in this process until we either get back to the column
<i>c</i><sub>0</sub>
(there we already have a free place), or when we compute coordinates which lie
outside the tissue (this may only happen when at least one tissue axis
is <em>not</em> the torus axis). The procedure is depicted here (for the first
type of termination):
</p>
<img src="./spread_synapses_exchange_scheme.svg" alt="[spread_synapses_exchange_scheme.svg]">
<p>
In each column we see only cells of the target kind <i>t</i>. That is because we move
synapses only amongst territories of these cells. All synapses which we move according
to the depicted arrows have two things in common. First, their source cells are of the
source kind <i>s</i> and second, they lie at the same index of territories of cells at the same
columnar coordinate (observe that moved synapses are depicted in the same positions within
columns).
</p><p>
</p><p>
Note that the algorithm is supposed to be called several times. Namely, for each
combination of a source kind <i>s</i> and a target kind <i>t</i> we need. In each such
combination we may provide a different specification matrix <i>H</i> (which is desired).
</p>
<h3 id="column_shift_function">Column-shift function</h3>
<p>
We provide and approach which is inspired in the <em>tiling plane</em> [1].
</p>
<h2 id="delimiters">Initialising delimiters of migration lists</h2>
<h2 id="references">References</h2>
<table>
    <tr><td>[1]</td><td>
        Wikipedia: List of convex uniform tilings.
        <a href="https://en.wikipedia.org/wiki/List_of_convex_uniform_tilings">
            https://en.wikipedia.org/wiki/List_of_convex_uniform_tilings</a>.
    </td></tr>
    <tr><td>[2]</td><td>
        Wikipedia: Tiling with rectangles.
        <a href="https://en.wikipedia.org/wiki/Tiling_with_rectangles">
            https://en.wikipedia.org/wiki/Tiling_with_rectangles</a>.
    </td></tr>
</table>
</body>
</html>
